---
globs: "src/**/*.{ts,tsx}"
description: "TypeScript 엄격 모드 컨벤션"
---

# TypeScript Rules

## 타입 정의
- `any` 사용 금지. `unknown`을 사용하고 타입 가드로 좁히기
- Props, API 응답, DB 모델 등은 반드시 명시적 타입 정의
- `interface` 우선 사용, union type이나 intersection이 필요한 경우 `type` 사용

```typescript
// Good
interface UserProfile {
  id: string;
  name: string;
  email: string;
  createdAt: Date;
}

type AnalysisStatus = 'pending' | 'processing' | 'completed' | 'failed';

type ApiResponse<T> = { data: T } | { error: string };

// Bad
const data: any = await fetch(...);
```

## 타입 파일 구조
```
src/types/
├── database.ts    # Supabase 자동생성 타입 + 커스텀 DB 타입
├── api.ts         # API 요청/응답 타입
└── ai.ts          # AI 관련 타입
```

## 패턴
```typescript
// API 응답 제네릭
interface ApiSuccessResponse<T> {
  data: T;
}

interface ApiErrorResponse {
  error: string;
  details?: string;
}

type ApiResponse<T> = ApiSuccessResponse<T> | ApiErrorResponse;

// Supabase 테이블 타입 활용
import { Database } from '@/types/database';
type User = Database['public']['Tables']['users']['Row'];
type InsertUser = Database['public']['Tables']['users']['Insert'];

// React 컴포넌트 Props
interface PageProps {
  params: Promise<{ id: string }>;
  searchParams: Promise<{ [key: string]: string | string[] | undefined }>;
}
```

## 타입 가드
```typescript
function isApiError(response: ApiResponse<unknown>): response is ApiErrorResponse {
  return 'error' in response;
}
```

## Strict Mode 설정
- `strict: true` 필수
- `noUncheckedIndexedAccess: true` 권장
- `exactOptionalPropertyTypes: true` 권장

## import 규칙
- Path alias `@/` 사용 (`@/components/`, `@/lib/`, `@/types/`)
- 타입만 import할 때는 `import type { ... }` 사용
